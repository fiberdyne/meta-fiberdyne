--------------------------------------------------------------------------------------------------
Fiberdyne Yocto Layer Setup
--------------------------------------------------------------------------------------------------

This tutorial will guide you in setting up the meta-fiberdyne Yocto layer for the Poky build environment.
For all purposes, the Yocto root directory will be referred to as $WORK.

-------------
Setup
-------------
1. Clone the meta-fiberdyne repository into $WORK:

   cd $WORK
   git clone ssh://git@alpha.fiberdyne.com.au:20122/yocto/meta-fiberdyne.git

2. Locate your Yocto bblayers configuration file at $WORK/build/conf/bblayers.conf and ensure that the 
   following lines areadded to the BBLAYERS variable:

       ${TOPDIR}/../meta-fiberdyne

   Locate your Yocto local configuration file at $WORK/build/conf/local.conf and ensure that the following
   lines are added to the IMAGE_INSTALL_append variable:
    
       fd-dsp \

3. Once your image is built, there will be three new commands which can be readily used:
      
   fd-dsp      - Run the main DSP background application
   fd-dsp-ui   - Run the DSP GUI application (requires fd-dsp to be running)
   fd-dsp-test - Run an audio test (required fd-dsp to be running)
  

4. You will need to ensure that Qt5 is also present, and the Boost C++ libraries.
   For instructions on installing these, visit http://elinux.org/R-Car/Boards/Yocto#Adding_Qt5_in_Yocto_image.
   
   
   
-------------------------------------------------------------------------------------------------------------
System audio setup and testing
-------------------------------------------------------------------------------------------------------------
ALSA has been used to define three audio sinks that supports simultaneous playback within multiple processes. 
The underlying ALSA driver supports 48000 KHz sample rate only.

1. sinkStereo 
   Dual channel 32-bit input that emulates any stereo audio (i.e :- music)

2. sinkTel 
   Single channel 32-bit input for telephone audio
  
3. sinkPdc
   Single channel 32-bit input for navigation audio and other mono audio sources

The test application fd-dsp-test uses the standard ALSA tool, aplay, to play stereo audio using sinkStereo. 
The other sinks can be tested via the same commands used in the test script. 

It must also be noted that, due to the AK4643 codec driver being implemented as a ALSA device driver, 
ALSA must be used to initialize the codec for 16-bit audio playback through the line out jack on the Porter board. 
The AK4643 ALSA device is available as "hw:0,0". Discussion about the steps involved in achieving this is 
beyond the scope of this document. 
